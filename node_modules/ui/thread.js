var React = require('react');

exports.Comment = React.createClass({
  render: function () {
    var userName = this.props.users[this.props.comment.user].name;
    return React.DOM.div({className: 'comment'}
      , React.DOM.span({className: 'user-name'}, userName + ':')
      , React.DOM.span({className: 'comment-body'}, this.props.comment.body)
      , exports.Thread({
        comments: this.props.comment.thread || []
        , depth: this.props.depth + 1
        , users: this.props.users
      })
    );
  }
});

exports.Thread = React.createClass({
  render: function () {
    var comments = {}
    , depth = this.props.depth
    , users = this.props.users
    ;
    this.props.comments.forEach(function (comment) {
      comments[comment.id] = exports.Comment({
        comment: comment
        , depth: depth
        , users: users
      });
    });

    return React.DOM.div({
      className: 'thread-depth-' + Math.min(this.props.depth, 2)
    }, comments);
  }
});
