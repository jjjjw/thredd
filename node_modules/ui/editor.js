var React = require('react');

module.exports = React.createClass({
  componentDidMount: function () {
    this.refs.editor.getDOMNode().focus();
  }
  , getInitialState: function () {
    return {text: ''};
  }
  , onChange: function (e) {
    this.setState({text: e.target.value});
  }
  , handleSubmit: function (e) {
    e.preventDefault();
    if (!this.state.text) {
      return;
    }
    var ev = new CustomEvent('commentEntered', {
      bubbles: true
      , detail: {
        body: this.state.text
        , parent: this.props.parent
      }
    });
    this.getDOMNode().dispatchEvent(ev);
    this.setState({text: ''});
  }
  , render: function () {
    return React.DOM.div({className: 'editor'}
      , React.DOM.form({onSubmit: this.handleSubmit}
        , React.DOM.textarea({className: 'editor', onChange: this.onChange, ref: 'editor', value: this.state.text})
        , React.DOM.button({className: 'post'}, 'Enter')
      )
    );
  }
});
