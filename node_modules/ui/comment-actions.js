var Commentor = require('./commentor')
  React = require('react/addons')
  ;

// sneaky singleton for rendered replies
var replyEditorInstance = null;

module.exports = React.createClass({
  getInitialState: function () {
    return { buttons: true, commentor: false };
  }
  , hideCommentor: function () {
    this.setState({ buttons: true, commentor: false })
  }
  , onReplyClicked: function (e) {
    if (replyEditorInstance) {
      replyEditorInstance.hideCommentor();
    }
    replyEditorInstance = this;
    this.setState({ buttons: false, commentor: true });
  }
  , render: function () {
    var inner;
    if (this.state.buttons) {
      inner = React.DOM.button({className: 'reply', onClick: this.onReplyClicked }, 'Reply');
    }
    if (this.state.commentor) {
      inner = Commentor({ parent: this.props.parent, hide: this.hideCommentor });
    }
    return React.DOM.span(null, inner);
  }
});
