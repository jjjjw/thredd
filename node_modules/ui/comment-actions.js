var Editor = require('./editor')
  , React = require('react/addons')
  ;

// sneaky singleton for rendered replies
var replyEditorInstance = null;

module.exports = React.createClass({
  getInitialState: function () {
    return { buttons: true, editor: false };
  }
  , hideEditor: function () {
    this.setState({ buttons: true, editor: false })
  }
  , onReplyClicked: function (e) {
    if (replyEditorInstance) {
      replyEditorInstance.hideEditor();
    }
    replyEditorInstance = this;
    this.setState({ buttons: false, editor: true });
  }
  , render: function () {
    var inner;
    if (this.state.buttons) {
      inner = React.DOM.button({className: 'reply', onClick: this.onReplyClicked }, 'Reply');
    }
    if (this.state.editor) {
      inner = Editor({ parent: this.props.parent, hide: this.hideEditor });
    }
    return React.DOM.span(null, inner);
  }
});
