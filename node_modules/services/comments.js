var coll = require('./collections/comments')
  , schema = require('./schemas/comment')
  , validateAndSave = require('./helpers').validateAndSave
  ;

exports.get = function (query) {
  return coll.find(query);
};

exports.getForArticles = function (articleList) {
  var article_ids = articleList.map(function (article) {
    return article.id;
  });
  return exports.get({ article: { $in: article_ids } });
};

exports.post = function (comment) {
  comment.createdAt = new Date().getTime();
  return validateAndSave(comment, schema, coll);
};
