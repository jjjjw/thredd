var coll = require('./collections').comments
  , findByField = require('./helpers').findByField
  , findById = require('./helpers').findById
  , listify =require('transforms').listify
  , schema = require('schemas/comment')
  , validateAndSave = require('./helpers').validateAndSave
  ;

exports.get = function (ids) {
  return findById(ids, coll);
};

exports.getForArticles = function (ids) {
  return findByField('article', ids, coll);
};

exports.getForUsers = function (ids) {
  return findByField('user', ids, coll);
};

exports.post = function (commentList) {
  commentList = listify(commentList).map(function (comment) {
    comment.createdAt = new Date().getTime();
    return comment;
  });
  return validateAndSave(commentList, schema, coll);
};
