var validator = require('./schemas/validator');

module.exports = {
  validateAndSave: function (model, schema, coll) {
    model._id = coll.id();
    model.id = model._id.toString();
    var isValid = validator.validate(model, schema);
    if (!isValid) {
      return new Promise(function (resolve, reject) {
        reject(validator.getLastErrors()[0]);
      });
    }
    return coll.insert(model);
  }
};
