var coll = require('./collections/users')
  , schema = require('./schemas/user')
  , validateAndSave = require('./helpers').validateAndSave
  ;

exports.get = function (query) {
  return coll.find(query);
};

exports.getForComments = function (commentList) {
  var user_ids = commentList.map(function (comment) {
    return coll.id(comment.user);
  });
  return exports.get({ _id: { $in: user_ids } });
};

exports.post = function (user) {
  return validateAndSave(user, schema, coll);
};
