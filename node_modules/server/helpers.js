var articles = require('services/articles')
  , commentsSvc = require('services/comments')
  , transforms = require('services/transforms')
  , usersSvc = require('services/users')
  ;

exports.getArticleData = function (id) {
  var article
  , comments
  , users
  ;

  return articles.get(id)
  .then(function (results) {
    article = results[0];
    if (!article) {
      throw new Error('404');
      return;
    }
    return commentsSvc.getForArticles(results);
  })
  .then(function (results) {
    comments = results;
    return usersSvc.getForComments(results);
  })
  .then(function (results) {
    users = results;
    return {
      article: article
      , comments: comments
      , users: users
    }
  });
};
