var coll = require('threads/collections/articles')
  , bacon = require('baconipsum')
  , comments = require('threads/services/comments')
  , schema = require('threads/schemas/article')
  , validateAndSave = require('./helpers').validateAndSave
  ;

exports.generateArticle = function () {
  var article = {
    body: bacon(1000)
    , title: bacon(5)
  };
  return exports.post(article);
};

exports.get = function (query) {
  return coll.find(query).then(function (results) {
    if (!results.length) {
      return exports.generateArticle().then(function (article) {
        return [article];
      });
    }
    return results;
  });
};

exports.post = function (article) {
  return validateAndSave(article, schema, coll);
};
