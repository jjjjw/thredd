var commentsSvc = require('services/comments')
  , Comment = require('ui/thread').Comment
  , fs = require('fs')
  , Mustache = require('mustache')
  , React = require('react')
  ;

var tmpl = fs.readFileSync(__dirname + '/templates/user-comments.mustache').toString();

module.exports = function (id) {
  return commentsSvc.getForUsers(id).then(function (comments) {
    console.log(comments, id)
    var commentsHtml = '';
    comments.forEach(function (comment) {
      commentsHtml += React.renderComponentToStaticMarkup(Comment({
        comment: comment
        , depth: 0
        , users: {}
      }));
    });

    return Mustache.render(tmpl, {
      commentsHtml: commentsHtml
    });
  });
};
